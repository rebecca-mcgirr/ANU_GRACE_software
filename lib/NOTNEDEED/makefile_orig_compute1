# Makefile for orbits on Darwin 10.4.0 by unimake at Wed Jul 28 14:51:06 EST 2010
#

all: grace_lib

# ASSIGMENTS        
### GCC V4 gfortran flags ###
FTN = gfortran
#FFLAGS = -O3 -mcmodel=medium -Wuninitialized -fno-f2c -ffast-math -fno-automatic -fno-backslash  -fbounds-check    
FFLAGS = -O3 -mcmodel=medium -Wuninitialized -fno-f2c -ffast-math -fno-automatic -fno-backslash   `nf-config --fflags`                 
CC = gcc
CFLAGS = -g

GRACE_LIB = grace_lib.a
SLIB = ../../gamit/lib/gamit_lib.a ../../libraries/comlib/com_lib.a ../../libraries/matrix/kinv_lib.a ../gracefit/gracefit_lib.a ../SPOTL/spotl.a
X11LIB = /usr/X11R6/lib
II = /usr/include/X11

grace_lib :  ../../libraries/comlib/com_lib.a $(GRACE_LIB) $(SLIB) ../includes/grace.param ../includes/gracefit.h90 ../includes/write_soln.h90 

$(GRACE_LIB) : \
	$(GRACE_LIB)(mascon_mod.o) \
	$(GRACE_LIB)(tide_netcdf_mod.o) \
	$(GRACE_LIB)(timing_mod.o) \
	$(GRACE_LIB)(amag3_quadprec.o) \
	$(GRACE_LIB)(calc_vector_component.o) \
	$(GRACE_LIB)(decompose_lib.o) \
	$(GRACE_LIB)(get_lambda.o) \
	$(GRACE_LIB)(invert.o) \
	$(GRACE_LIB)(jplephem.o) \
	$(GRACE_LIB)(legendre_matrix.o) \
	$(GRACE_LIB)(matmult.o) \
	$(GRACE_LIB)(matmult_quad.o) \
	$(GRACE_LIB)(msc_lib.o) \
	$(GRACE_LIB)(printmat.o) \
        $(GRACE_LIB)(read_soln_v1.o)\
        $(GRACE_LIB)(read_soln_v2.o)\
        $(GRACE_LIB)(read_soln_v3.o)\
        $(GRACE_LIB)(running_mean.o)\
        $(GRACE_LIB)(cross.o)\
	$(GRACE_LIB)(cross_quadprec.o) \
        $(GRACE_LIB)(dot.o)\
        $(GRACE_LIB)(dot_quad.o)\
        $(GRACE_LIB)(findquat.o)\
        $(GRACE_LIB)(findquat_quad.o)\
        $(GRACE_LIB)(gsec_to_ymdhms.o)\
        $(GRACE_LIB)(lininterp_r8.o)\
        $(GRACE_LIB)(PEPtime.o)\
        $(GRACE_LIB)(physics_constants.o)\
        $(GRACE_LIB)(physics_msis.o)\
	$(GRACE_LIB)(pnm_calc.o)\
        $(GRACE_LIB)(quat_lib.o)\
        $(GRACE_LIB)(quat_lib_quad.o)\
	$(GRACE_LIB)(read_sphharm.o)\
	$(GRACE_LIB)(rotmat2rpy.o)\
	$(GRACE_LIB)(rpy2rotmat.o)\
        $(GRACE_LIB)(smooth.o)\
        $(GRACE_LIB)(spotl_tide_lib.o)\
        $(GRACE_LIB)(SRF_2_LOS.o)\
        $(GRACE_LIB)(srf_2_los_quadprec.o)\
        $(GRACE_LIB)(tide_lib.o)\
        $(GRACE_LIB)(utils_constants.o)\
        $(GRACE_LIB)(utils_spline.o)\
	$(GRACE_LIB)(write_soln.o)\
	$(GRACE_LIB)(write_soln_v2.o)\
	$(GRACE_LIB)(write_soln_gracekal_v1.o)\
	$(GRACE_LIB)(which_primary_msc.o)
	ranlib grace_lib.a
 
$(GRACE_LIB)(write_soln.o): ../includes/write_soln.h90 ../includes/grace.param
$(GRACE_LIB)(write_soln_v2.o): ../includes/write_soln.h90 ../includes/grace.param
$(GRACE_LIB)(read_soln_v1.o): ../includes/write_soln.h90 ../includes/grace.param
$(GRACE_LIB)(read_soln_v2.o): ../includes/write_soln.h90 ../includes/grace.param
$(GRACE_LIB)(running_mean.o): ../includes/grace.param
$(GRACE_LIB)(tide_lib.o): accel_mod.mod tide_mod.mod tide_netcdf_mod.mod
$(GRACE_LIB)(msc_lib.o): mascon_mod.mod            
$(GRACE_LIB)(tide_netcdf_mod.o): /usr/include/netcdf.mod            
.c.a:
	$(CC) -c $(CFLAGS)  -I$(II) $<
	ar rv $@ *.o
	rm -f $*.o

.f90.a:
	$(FTN) -c $(FFLAGS) $<
	ar rv $@ *.o
	rm -f $*.o

.f95.a:
	$(FTN) -c $(FFLAGS) $<
	ar rv $@ *.o
	rm -f $*.o

.f.a:
	$(FTN) -c $(FFLAGS) $<
	ar rv $@ *.o
	rm -f $*.o

.SUFFIXES: .f90 .f95
